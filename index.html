<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Phoenix Pull</title>

  <!-- Google Font: Plus Jakarta Sans -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Tailwind (no build step) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['"Plus Jakarta Sans"', 'ui-sans-serif', 'system-ui', 'Apple Color Emoji'] },
          colors: {
            brand: '#0ea5e9',   /* sky-500 */
            ink: '#0f172a',     /* slate-900 */
            muted: '#64748b',   /* slate-500 */
            bg: '#f8fafc',      /* slate-50 */
            card: '#ffffff',
            line: '#e5e7eb',    /* gray-200 */
          },
          boxShadow: {
            soft: '0 8px 30px rgba(15, 23, 42, .06)',
            sheet: '0 -20px 50px rgba(15, 23, 42, .12)',
          }
        }
      }
    }
  </script>
  <style>
    html,body{height:100%}
    body{background: linear-gradient(180deg, #ffffff 0%, #f8fafc 40%);}
    .safe-x{padding-left:max(16px, env(safe-area-inset-left)); padding-right:max(16px, env(safe-area-inset-right))}
    .safe-b{padding-bottom:max(16px, env(safe-area-inset-bottom))}
    .tap{min-height:52px}
    .glass{background:rgba(255,255,255,.85);backdrop-filter:saturate(180%) blur(10px)}
    .chip{border:1px solid var(--line, #e5e7eb); background:#fff}
    .chip.active{background:#0ea5e9; color:#fff; border-color:transparent; box-shadow:0 8px 24px rgba(14,165,233,.25)}
    /* Bottom sheet */
    .sheet-wrap{position:fixed;inset:0;display:none;align-items:end;justify-content:center;background:rgba(0,0,0,.35);z-index:60}
    .sheet-wrap.open{display:flex}
    .sheet{width:100%;max-width:720px;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px;box-shadow:var(--tw-shadow, 0 -20px 50px rgba(15,23,42,.12));margin-bottom:calc(env(safe-area-inset-bottom) + 6px)}
    .divider{height:1px;background:linear-gradient(90deg, transparent, rgba(2,6,23,.08), transparent)}
    .btn{transition:transform .04s ease} .btn:active{transform:scale(.98)}
    .grid-cards{display:grid;grid-template-columns:1fr;gap:14px}
    @media(min-width:900px){ .grid-cards{grid-template-columns:1fr 1fr} }
  </style>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Real config (from your upload) -->
  <script src="config.js"></script>
  <script defer src="app.js"></script>
</head>
<body class="text-ink font-sans">
  <!-- LOGIN -->
  <section id="view-login" class="min-h-screen grid place-items-center p-6">
    <div class="w-full max-w-md bg-card border border-line rounded-2xl shadow-soft p-6">
      <h1 class="text-xl font-extrabold text-brand">Phoenix Pull</h1>
      <p id="loginHint" class="text-muted text-sm mt-1">Sign in or create an account.</p>
      <form id="loginForm" class="grid gap-3 mt-4">
        <label class="grid gap-1">
          <span class="text-sm text-muted">Email</span>
          <input id="loginEmail" class="bg-white border border-line rounded-xl px-3 py-3" type="email" required />
        </label>
        <label class="grid gap-1">
          <span class="text-sm text-muted">Password</span>
          <input id="loginPass" class="bg-white border border-line rounded-xl px-3 py-3" type="password" required />
        </label>
        <button class="btn tap rounded-xl bg-brand text-white font-extrabold" type="submit">Sign in</button>
      </form>
      <div class="flex items-center justify-between mt-3">
        <button id="toSignup" class="text-sm text-brand underline">Create account</button>
        <button id="resetPw" class="text-sm text-muted underline">Reset password</button>
      </div>
    </div>

    <dialog id="signupDialog" class="w-full max-w-md bg-card border border-line rounded-2xl shadow-soft p-6">
      <form id="signupForm" method="dialog" class="grid gap-3">
        <h2 class="text-lg font-bold">Create account</h2>
        <label class="grid gap-1">
          <span class="text-sm text-muted">Email</span>
          <input id="signupEmail" class="bg-white border border-line rounded-xl px-3 py-3" type="email" required />
        </label>
        <label class="grid gap-1">
          <span class="text-sm text-muted">Password</span>
          <input id="signupPass" class="bg-white border border-line rounded-xl px-3 py-3" type="password" required />
        </label>
        <label class="grid gap-1">
          <span class="text-sm text-muted">Display name</span>
          <input id="signupName" class="bg-white border border-line rounded-xl px-3 py-3" type="text" placeholder="e.g., Alex" />
        </label>
        <div class="flex gap-2 justify-end mt-2">
          <button value="cancel" class="tap border border-line rounded-xl px-4">Cancel</button>
          <button class="btn tap rounded-xl bg-brand text-white font-extrabold px-4" type="submit">Sign up</button>
        </div>
      </form>
    </dialog>
  </section>

  <!-- ADMIN -->
  <section id="view-admin" class="hidden">
    <header class="safe-x glass sticky top-0 z-50 border-b border-line py-2">
      <div class="flex items-center gap-2">
        <h1 class="text-lg font-extrabold text-brand">Admin</h1>
        <div class="ml-auto flex items-center gap-2">
          <button id="gotoApp" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Go to App</button>
          <button id="logoutA" class="btn tap rounded-xl bg-ink text-white px-4">Log out</button>
        </div>
      </div>
    </header>
    <main class="safe-x py-4 space-y-4">
      <div class="grid md:grid-cols-2 gap-4">
        <section class="bg-card border border-line rounded-2xl p-4 shadow-soft">
          <h2 class="font-bold mb-2">Users</h2>
          <form id="inviteForm" class="flex flex-wrap gap-2 mb-3">
            <input id="inviteEmail" class="bg-white border border-line rounded-xl px-3 py-3 flex-1 min-w-[200px]" placeholder="email@domain.com" type="email" required />
            <select id="inviteRole" class="bg-white border border-line rounded-xl px-3 py-3">
              <option value="user">user</option>
              <option value="admin">admin</option>
            </select>
            <button class="btn tap rounded-xl bg-brand text-white font-extrabold px-4" type="submit">Invite</button>
          </form>
          <div id="usersTable" class="overflow-auto"></div>
        </section>
        <section class="bg-card border border-line rounded-2xl p-4 shadow-soft">
          <div class="flex items-center gap-2 mb-2">
            <h2 class="font-bold">Interactions</h2>
            <div class="ml-auto flex items-center gap-2">
              <select id="logUserFilter" class="bg-white border border-line rounded-xl px-3 py-2"></select>
              <select id="logActionFilter" class="bg-white border border-line rounded-xl px-3 py-2">
                <option value="all">All actions</option>
                <option value="qty_change">Qty changed</option>
                <option value="restock_toggle">Restock toggled</option>
                <option value="send_summary">Send summary</option>
                <option value="login">Login</option>
                <option value="logout">Logout</option>
              </select>
              <button id="exportCSV" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Export CSV</button>
              <button id="clearLogs" class="btn tap rounded-xl border-2 border-red-500 text-red-500 px-4">Clear Logs</button>
            </div>
          </div>
          <div id="logsTable" class="overflow-auto"></div>
        </section>
      </div>
    </main>
  </section>

  <!-- APP -->
  <section id="view-app" class="hidden">
    <header class="safe-x glass sticky top-0 z-40 border-b border-line py-2">
      <div class="flex items-center gap-2">
        <h1 class="text-lg font-extrabold text-brand">Pull List</h1>
        <div id="who" class="text-sm text-muted"></div>
        <div class="ml-auto flex items-center gap-2">
          <button id="adminBtn" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Admin</button>
          <button id="logout" class="btn tap rounded-xl bg-ink text-white px-4">Log out</button>
        </div>
      </div>
      <div class="flex items-center gap-2 my-2">
        <input id="search" class="flex-1 min-w-[140px] bg-white border border-line rounded-xl px-3 py-3" type="search" placeholder="Search itemsâ€¦" autocomplete="off" />
        <label class="flex items-center gap-2 border border-line rounded-xl px-3 py-2 bg-white">
          <input id="onlyQty" type="checkbox" class="accent-brand" /> <span class="text-sm">Only qty</span>
        </label>
      </div>
      <div id="chips" class="flex gap-2 overflow-x-auto py-2"></div>
    </header>

    <main class="safe-x pb-[calc(96px+env(safe-area-inset-bottom))] pt-2">
      <div id="list" class="grid-cards"></div>
    </main>

    <div class="safe-x safe-b fixed left-0 right-0 bottom-0 z-50 glass border-t border-line">
      <div class="flex items-center gap-2 py-2">
        <button id="send" class="btn tap rounded-xl bg-brand text-white font-extrabold px-5">Send</button>
        <button id="copy" class="btn tap rounded-xl border-2 border-brand text-brand px-5">Copy</button>
        <button id="clear" class="btn tap rounded-xl bg-ink text-white px-5">Clear</button>
        <div class="ml-auto font-extrabold" id="total">0</div>
      </div>
    </div>

    <!-- Bottom Sheet -->
    <div class="sheet-wrap" id="modal" role="dialog" aria-modal="true" aria-labelledby="sumTitle">
      <div class="sheet">
        <header class="safe-x border-b border-line py-3">
          <div class="flex items-center justify-between">
            <h3 id="sumTitle" class="text-lg font-bold">Summary</h3>
            <button id="close" class="btn rounded-lg border border-line px-3 py-2">Close</button>
          </div>
        </header>
        <div class="max-h-[60vh] overflow-auto p-4" id="summary"></div>
        <div class="divider"></div>
        <footer class="safe-x py-3 flex items-center gap-2 justify-end">
          <button id="copyPull" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Copy Pull</button>
          <button id="copyRestock" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Copy Restock</button>
          <button id="print" class="btn tap rounded-xl border-2 border-brand text-brand px-4">Print</button>
        </footer>
      </div>
    </div>
  </section>
</body>
</html>
